<div class="container mt-5">
  <h2>Complete Your Profile</h2>
  <div class="progress mb-4">
    <div class="progress-bar" role="progressbar" style="width: 60%;" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
  </div>
  
  <form [formGroup]="profileForm">
    <!-- Profile Photo -->
    <div class="mb-4">
      <h4>Add your profile photo</h4>
      <div class="d-flex align-items-center">
        <div class="profile-photo-placeholder me-3">
          <img [src]="previewUrl" alt="Profile Photo" class="rounded-circle" width="150" height="150">
        </div>
        <div>
          <p>Your profile photo will appear on your profile and directory listing.</p>
          <p>PNG or JPG no bigger than 1000px wide and tall.</p>
          <input type="file" (change)="onFileChange($event)" accept="image/png, image/jpeg">
          <div *ngIf="profileForm.get('image')?.touched && profileForm.get('image')?.errors?.['required']" class="text-danger">
            Profile photo is required.
          </div>
        </div>
      </div>
    </div>

    <!-- About Section -->
    <div class="mb-4">
      <h4>About you and your business</h4>
      <textarea formControlName="about" class="form-control" rows="5" 
                placeholder="Tell potential customers about yourself and your business"></textarea>
      <div *ngIf="profileForm.get('about')?.touched && profileForm.get('about')?.errors" class="text-danger">
        <div *ngIf="profileForm.get('about')?.errors?.['required']">About section is required.</div>
        <div *ngIf="profileForm.get('about')?.errors?.['minlength']">
          About section should be at least 50 characters.
        </div>
      </div>
    </div>

    <!-- Website -->
    <div class="mb-4">
      <h4>Have a website?</h4>
      <input type="url" formControlName="website" class="form-control" placeholder="https://">
      <div *ngIf="profileForm.get('website')?.touched && profileForm.get('website')?.errors?.['pattern']" class="text-danger">
        Please enter a valid URL starting with http:// or https://
      </div>
    </div>
  </form>

  <!-- Price and Hours Form -->
  <form [formGroup]="scheduleForm">
    <h4>Add price and payment method</h4>
    <div class="mb-4">
      <label>Price *</label>
      <div class="input-group">
        <span class="input-group-text">$</span>
        <input type="number" formControlName="price" class="form-control" placeholder="Set a fair price">
        <select formControlName="priceUnit" class="form-select">
          <option value="per_hour">per hour</option>
          <option value="per_project">per project</option>
        </select>
      </div>
      <div *ngIf="scheduleForm.get('price')?.touched && scheduleForm.get('price')?.errors" class="text-danger">
        <div *ngIf="scheduleForm.get('price')?.errors?.['required']">Price is required.</div>
        <div *ngIf="scheduleForm.get('price')?.errors?.['min']">Price must be at least $1.</div>
      </div>
    </div>

    <div class="mb-4">
      <h5>Get paid quickly and securely online</h5>
      <p>Enable clients to pay instantly via credit card, so you'll never have to wait for another check to clear.</p>
      <button type="button" class="btn btn-outline-primary">+ Add card</button>
    </div>

    <h4>Add working hours</h4>
    <div formArrayName="schedules">
      <div *ngFor="let schedule of schedules.controls; let i=index" [formGroupName]="i" class="mb-3">
        <div class="d-flex align-items-center">
          <div class="form-check me-3">
            <input type="checkbox" class="form-check-input" formControlName="enabled">
            <label class="form-check-label">{{ daysOfWeek[i] }}</label>
          </div>
          <select formControlName="availableFrom" class="form-select me-2" [disabled]="!schedule.get('enabled')?.value">
            <option *ngFor="let hour of hours" [value]="hour">{{ hour }}</option>
          </select>
          <span class="me-2">to</span>
          <select formControlName="availableTo" class="form-select" [disabled]="!schedule.get('enabled')?.value">
            <option *ngFor="let hour of hours" [value]="hour">{{ hour }}</option>
          </select>
        </div>
      </div>
    </div>
    <div *ngIf="scheduleForm.get('schedules')?.touched && scheduleForm.get('schedules')?.errors?.['noSchedule']" class="text-danger">
      Please select at least one working day.
    </div>
  </form>

  <!-- Submit Button and Error Message -->
  <div class="d-flex justify-content-between mt-4">
    <button type="button" class="btn btn-primary" (click)="onSubmit()">Go to first project</button>
    <a routerLink="/account" class="btn btn-link">Add project later</a>
  </div>
  <div *ngIf="errorMessage" class="alert alert-danger mt-2">
    {{ errorMessage }}
  </div>
</div>