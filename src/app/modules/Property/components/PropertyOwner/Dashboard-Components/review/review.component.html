<div class="page">
  <div class="container my-box">
    <div class="reviews-container">
      <h2 class="reviews-title">Property Reviews</h2>

      @if(isLoading) {
        <div class="loading-container">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <p class="mt-3">Loading reviews...</p>
        </div>
      } @else if(hasError) {
        <div class="error-container">
          <div class="error-icon">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <h3>Oops! Something went wrong</h3>
          <p>{{ errorMessage }}</p>
          <button class="btn btn-gradient" (click)="getReviews()">
            <i class="fas fa-redo me-2"></i>
            Try Again
          </button>
        </div>
      } @else if(reviews.length === 0) {
        <div class="empty-state">
          <div class="empty-icon">
            <i class="fas fa-star"></i>
          </div>
          <h3>No Reviews Found</h3>
          <p>There are currently no reviews for your properties. Reviews will appear here once guests start leaving feedback.</p>
        </div>
      } @else {
        <!-- Reviews Summary -->
        <div class="reviews-summary">
          <div class="summary-card">
            <div class="summary-icon">
              <i class="fas fa-star"></i>
            </div>
            <div class="summary-content">
              <h3>{{ reviews.length }}</h3>
              <p>Total Reviews</p>
            </div>
          </div>
          <div class="summary-card">
            <div class="summary-icon">
              <i class="fas fa-chart-line"></i>
            </div>
            <div class="summary-content">
              <h3>{{ getAverageRating().toFixed(1) }}</h3>
              <p>Average Rating</p>
            </div>
          </div>
        </div>

        <!-- Reviews List -->
        <div class="reviews-list">
          <div class="review-card" *ngFor="let review of reviews; trackBy: trackByReviewId">
            <div class="review-header">
              <div class="reviewer-info">
                <div class="reviewer-avatar">
                  <i class="fas fa-user"></i>
                </div>
                <div class="reviewer-details">
                  <h4 class="reviewer-name">{{ review.ClientName }}</h4>
                  <p class="property-name">{{ review.PropertyName }}</p>
                </div>
              </div>
              <div class="review-date">
                <i class="fas fa-calendar-alt"></i>
                {{ formatDate(review.ModificationDateTime) }}
              </div>
            </div>

            <div class="review-rating">
              <div class="stars-container">
                <i 
                  *ngFor="let star of getRatingStars(review.Rating); let i = index" 
                  class="fas fa-star star"
                  [class.filled]="star === 1"
                  [class.empty]="star === 0">
                </i>
              </div>
              <span class="rating-text" [ngClass]="getRatingClass(review.Rating)">
                {{ review.Rating }}/5
              </span>
            </div>

            <div class="review-content">
              <p class="review-comment">{{ review.Comments }}</p>
            </div>

            <div class="review-footer">
              <div class="review-id">
                <i class="fas fa-hashtag"></i>
                Review #{{ review.Id }}
              </div>
            </div>
          </div>
        </div>
      }
    </div>
  </div>
</div>
